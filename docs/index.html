<html>
	<head>
		<title>Schmokin</title>
        <meta charset="UTF-8">
        <meta name="description" content="A wrapper for curl providing chainable assertions written in bash for creating simple but powerful smoke tests.">
        <meta name="keywords" content="devops,programming,software,testing,bash">
        <meta name="author" content="Andrew Rea">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://fonts.googleapis.com/css?family=Bangers|Passion+One|Shadows+Into+Light" rel="stylesheet">
		<link href="/css/bootstrap.min.css" rel="stylesheet">
		<link href="/css/main.css" rel="stylesheet">
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123266654-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-123266654-1');
        </script>
	</head>
	<body>
        <a href="https://github.com/reaandrew/schmokin"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
		<div class="container">
			<div class="row mt-5">
				<div class="col-12">
                    <div class="row">
                        <div class="col">
				            <h1 class="display-1 text-center text-secondary">schmokin</h1>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center">
                            <h2>A wrapper for curl providing chainable assertions to create simple but powerful smoke tests all written in bash</h2>
                        </div>
                    </div>
                    <div class="row mt-3 mb-3">
                        <div class="col-12">
                            <h1>install . . .</h1>
                        </div>
                        <div class="col-12">
                            <div class="alert alert-secondary text-left code" role="alert">
                                <pre class="mb-0"><code>curl -Ls https://github.com/reaandrew/schmokin/releases/download/latest/schmokin_install | bash</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3 mb-3">
                        <div class="col-12">
                            <h1>use . . .</h1>
                        </div>
                        <div class="col-12">
                            <div class="alert alert-secondary text-left code" role="alert">
                                <pre class="mb-0"><code>schmokin &lt;url&gt; [schmokin-args] -- [curl-args]</code></pre>
                            </div>
                        </div>
                    </div>
				</div>
			</div>
            <div class="row">
                <div class="col">
                    <h3 class="text-secondary">Simple set of assertions</h3>
					<table class="table text-left">
					  <thead class="thead-dark">
						<tr>
						  <th scope="col">flag</th>
						  <th scope="col">description</th>
						</tr>
					  </thead>
					  <tbody>
						<tr>
						  <th scope="row">--eq</th>
						  <td>equals</td>
						</tr>
						<tr>
						  <th scope="row">--gt</th>
						  <td>greater than</td>
						</tr>
						<tr>
						  <th scope="row">--ge</th>
						  <td>greater than or equals</td>
						</tr>
						<tr>
						  <th scope="row">--lt</th>
						  <td>less than</td>
						</tr>
						<tr>
						  <th scope="row">--le</th>
						  <td>less than or equals</td>
						</tr>
						<tr>
						  <th scope="row">--co</th>
						  <td>contains</td>
						</tr>
					  </tbody>
					</table>
                </div>
                <div class="col">
                    <h3 class="text-secondary">Simple set of extractors</h3>
					<table class="table text-left">
					  <thead class="thead-dark">
						<tr>
						  <th scope="col">flag</th>
						  <th scope="col">description</th>
						</tr>
					  </thead>
					  <tbody>
						<tr>
						  <th scope="row">--jq</th>
						  <td><a href="https://stedolan.github.io/jq/">JQ</a> expression</td>
						</tr>
						<tr>
						  <th scope="row">--req-header</th>
						  <td>HTTP Request Header</td>
						</tr>
						<tr>
						  <th scope="row">--resp-header</th>
						  <td>HTTP Response Header</td>
						</tr>
						<tr>
						  <th scope="row">--resp-body</th>
						  <td>HTTP Response Body</td>
						</tr>
						<tr>
						  <th scope="row">--status</th>
						  <td>HTTP Status</td>
						</tr>
					  </tbody>
					</table>
                </div>
                <div class="col">
                    <h3 class="text-secondary">Utilities</h3>
					<table class="table text-left">
					  <thead class="thead-dark">
						<tr>
						  <th scope="col">flag</th>
						  <th scope="col">description</th>
						</tr>
					  </thead>
					  <tbody>
						<tr>
						  <th scope="row">--export</th>
						  <td>Export extracted variable</td>
						</tr>
						<tr>
						  <th scope="row">--debug</th>
						  <td>Show verbose curl output</td>
						</tr>
					  </tbody>
					</table>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <h3 class="text-secondary">Uses <a href="https://stedolan.github.io/jq/">JQ</a> under the hood for JSON extraction</h3>
                    <div class="alert alert-secondary" role="alert">
                        <pre class="mb-0"><code>./schmokin $URL --jq '.status' --eq "UP"</code></pre>
                    </div>
                </div>
                <div class="col-12">
                    <h3 class="text-secondary">Shiny output</h3>
                    <img class="img-fluid shadow-lg mb-5 bg-white rounded" src="/images/shiny-example.png"></img>
                </div>
                <div class="col-12">
                    <h3 class="text-secondary">Adds to existing curl capabilities</h3>
                    <p>Any extra curl arguments can be placed after the <code>--</code> separator.</p>
                    <div class="alert alert-secondary" role="alert">
                        <pre class="mb-0"><code>./schmokin $URL --req-header "X-FU" --eq 'BAR' -- -H "X-FU: BAR"</code></pre>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <h1>Examples</h1>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Assert on HTTP status</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --status -eq 200</code></pre>
                            </div>
                        </div>
                        <div class="col">
                            <h3 class="text-secondary">Equals Assertion</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '.status' --eq "UP"</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Greater Than Assertion</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '. | length' --gt 4</code></pre>
                            </div>
                        </div>
                        <div class="col">
                            <h3 class="text-secondary">Greater Than or Equals Assertion</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '. | length' --ge 6</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Less Than Assertion</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '. | length' --lt 4</code></pre>
                            </div>
                        </div>
                        <div class="col">
                            <h3 class="text-secondary">Less Than or Equals Assertion</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '. | length' --le 6</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Range Assertions</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $ENDPOINT/created --status --gt 200 --lt 202</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Request Header Extractor</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --req-header "X-FU" --eq 'BAR' -- -H "X-FU: BAR"</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Response Header Extractor</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --resp-header "Content-Type" --eq 'application/json'</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Response Body Extractor</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --resp-body --eq 'UP' -- -X POST -d 'UP'</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">JQ Extractor</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code>schmokin $URL --jq '.status' --eq "UP"</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h3 class="text-secondary">Export Utility</h3>
                            <div class="alert alert-secondary" role="alert">
                                <pre class="mb-0"><code># Store the status message of the application in a variable named appStatus
schmokin $ENDPOINT/simple --jq '.status' --export appStatus 

# Post the appStatus value and assert on the value
schmokin $ENDPOINT/echo --jq '.message' --eq 'UP' -- -X POST -d '{\"message\":\"$appStatus\"}'
</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
		</div>
        <canvas id="canvas"></canvas>
        <script src="/js/smoke.js"></script>
        <script>

            function getRandomInt(min, max) {
                  return Math.floor(Math.random() * Math.floor(max-min)) + min;
            }

            var can = document.getElementById("canvas");
            var ctx = canvas.getContext('2d');

            function resizeCanvas() {
                  can.style.width = window.innerWidth + "px";
                  setTimeout(function() {
                          can.style.height = window.innerHeight + "px";
                        }, 0);
            };

            // Webkit/Blink will fire this on load, but Gecko doesn't.
            window.onresize = resizeCanvas;

            // So we fire it manually...
            resizeCanvas();
            var party = smokemachine(ctx,[192,192,192]);
            party.start()

            window.setInterval(function(){
                party.addsmoke(getRandomInt(0, window.innerWidth),getRandomInt(0, window.innerHeight),getRandomInt(10, 50))
            },250);
        </script>
	</body>
</html>
